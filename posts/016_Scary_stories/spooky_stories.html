<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eleni">
<meta name="dcterms.date" content="2025-10-30">
<meta name="description" content="An exploration of how large language models can help you craft eerie, unsettling Halloween stories that blur the line between human imagination and machine-made horror.">

<title>Writing Scary Stories with Gemini – My Explorations With LLMs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-84e45be2601fe28dd90bd5a99269035f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My Explorations With LLMs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/lazyexcuseforausername"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/elenikan/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Writing Scary Stories with Gemini</h1>
                  <div>
        <div class="description">
          An exploration of how large language models can help you craft eerie, unsettling Halloween stories that blur the line between human imagination and machine-made horror.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">Writing</div>
                <div class="quarto-category">Creativity</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Eleni </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 30, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>I grew up obsessed with <em>Scary Stories to Tell in the Dark</em> by Alvin Schwartz—the gross, weird, perfectly campfire-creepy tales that made you want to both slam the book shut and keep reading. These stories were a staple for my friends and I around Halloween especially! This blog is my attempt in seeing if a large language model can tap into that same feeling: the slow-burn dread, the offbeat punchlines, the images that linger a little too long in your head. To test it, I’ll be running two different setups: first, an unstructured prompt where I basically just ask the LLM for a story outright, and second, a structured prompt modeled after our class tutor task, where I spell out specific constraints such as: tone, length, narrative beats, scare level, audience, etc. and see how closely the model can follow instructions while still being scary. Then I’ll compare how each approach shapes the vibes, the scares, and the overall storytelling.</p>
<p><img src="Hallowen_image.png" class="img-fluid"></p>
<p>For this experiment we will be working with <strong>Gemini 2.5 Flash</strong> and my prompts will be in <strong>green</strong> and the LLM’s output will be in <strong>Purple</strong></p>
<section id="unstructured-prompt" class="level2">
<h2 class="anchored" data-anchor-id="unstructured-prompt">Unstructured Prompt</h2>
<div style="background-color:#e0f7e9; padding:12px 16px; border-radius:8px; border:1px solid #b2e2c4;">
<p>Write me a scary story</p>
</div>
<div style="background-color:#e9d5ff; padding:12px 16px; border-radius:8px; border:1px solid #c4b5fd;">
<p>The antique mirror sat in the corner of my new apartment, a silent sentinel. I’d found it in a dusty junk shop, its ornate, tarnished silver frame and deep, smoky glass a stark contrast to my minimalist decor. “A conversation piece,” I’d told myself, as I haggled the old man down to a ridiculous price. He’d eyed me strangely, a flicker of something I couldn’t quite decipher in his rheumy gaze, before taking my money with a shrug.</p>
<p>At first, it was just beautiful. I loved how it seemed to swallow the light, creating a darker, more melancholic reflection than any other mirror I owned. But then, the subtle things started.</p>
<p>I’d catch a movement in its depths from the corner of my eye – a fleeting shadow, a shift in the background that wasn’t there when I turned to look directly. My reflection, sometimes, would seem to linger for a fraction of a second after I’d moved away, a ghostly afterimage. I dismissed it as tricks of light, the old glass, my tired eyes.</p>
<p>Then came the sounds. Faint whispers, like dry leaves skittering across pavement, when the apartment was otherwise silent. A soft scratching from behind the mirror, rhythmic and persistent, usually in the dead of night. I checked the wall, convinced it was mice, but found nothing.</p>
<p>Sleep became a luxury. I’d wake in a cold sweat, certain I wasn’t alone. My gaze would inevitably drift to the mirror, and in the faint moonlight, I’d swear my reflection wasn’t quite right. The eyes seemed a little too wide, the mouth a little too thin, a faint, almost imperceptible smile playing on the lips. And it was always looking <em>at</em> me, not just reflecting me.</p>
<p>One evening, I brought a friend over. She gasped when she saw the mirror. “It’s stunning, but… it feels cold,” she said, running a hand over the frame. “And there’s something about your reflection in it. It looks… sadder. Older.” I laughed it off, but a chill snaked up my spine.</p>
<p>The mirror began to show me things that weren’t there. When I brushed my teeth, I’d see a gaunt, pale face peering over my shoulder in the reflection, its features indistinct, its eyes like twin pools of ink. When I tried to focus, it would vanish, leaving only my own terrified face staring back.</p>
<p>I started avoiding the mirror, turning it to face the wall, even covering it with a sheet. But the presence remained. The whispers grew louder, more insistent, weaving my name into their unintelligible murmurings. The scratching intensified, sounding less like an animal and more like fingernails dragging across wood.</p>
<p>One night, the sheet fell. I woke to a sudden, sharp crack. The apartment was bathed in the sickly glow of the streetlights outside. The mirror was facing me. My heart hammered against my ribs.</p>
<p>In its depths, it wasn’t my reflection staring back. It was <em>her</em>.</p>
<p>The gaunt, pale woman from my nightmares. Her skin was stretched taut over sharp cheekbones, her hair lank and greasy. Her eyes, those twin pools of ink, were fixed on me with an expression of profound, ancient hunger. And on her lips, that faint, unsettling smile had widened, revealing teeth that seemed a little too long, a little too sharp.</p>
<p>She raised a hand, her fingers skeletal, and pressed it against the glass. I heard a faint <em>thump</em> from the mirror’s surface, a sound that shouldn’t have been possible. Then, slowly, terrifyingly, <em>my</em> reflection began to appear behind her. My normal, healthy reflection. But it was screaming. Soundlessly. Its mouth was open in a silent, desperate plea, its eyes wide with terror, as the gaunt woman’s hand seemed to <em>sink</em> into its chest.</p>
<p>The woman in the mirror leaned closer, her breath fogging the glass, though I felt no warmth, only an icy dread.</p>
<p>“You’ve been watching me,” I whispered, my voice raw.</p>
<p>Her smile broadened. And then, from the depths of the mirror, I heard a voice. It was my voice, but twisted, hollow, filled with an unbearable sorrow.</p>
<p>“No,” it whispered, “I’ve been waiting.”</p>
<p>The room grew colder. The scratching from behind the mirror intensified, frenzied and desperate. And as I watched, horrified, the gaunt woman’s inky eyes locked onto mine, and she began to pull. My reflection, still screaming silently, began to recede, dissolving into the smoky depths of the glass, pulled away by the skeletal hand.</p>
<p>I stumbled back, tripping over my own feet, my breath catching in my throat. I couldn’t look away. The woman in the mirror was still smiling, her eyes fixed on me, beckoning. And as my own reflection finally vanished into the darkness behind her, her gaze seemed to deepen, to intensify, as if she were seeing not just me, but the empty space <em>within</em> me.</p>
<p>The last thing I saw before the darkness truly swallowed me was her reaching out again, not for the fading image of myself, but for <em>me</em>. And this time, I felt the cold, skeletal touch against my very soul.</p>
<p>The apartment is empty now. The mirror still sits in the corner, its ornate, tarnished silver frame catching the light, its deep, smoky glass reflecting nothing but the quiet room. And if you look closely, very closely, you might just catch a flicker in its depths – a fleeting shadow, a shift in the background that isn’t there when you turn to look directly. And sometimes, very rarely, in the dead of night, you might hear a faint whisper, like dry leaves skittering across pavement, calling a name you don’t recognize. And if you’re truly unlucky, you might see a faint, almost imperceptible smile playing on the lips of the reflection that stares back at you, its eyes a little too wide, a little too thin. Waiting.</p>
</div>
<p>So while reading this.. there were a few things I wanted to touch on - the level of vocabulary did not seem consistent. For example it used advanced words such as “sentinel” and “rheumy” but kept things very flavorless and vague in other sections like at the end of the first paragraph “the subtle things started”. In my opinion, this is very unnatural - Furthermore, I was a little dissapointed with the dialouge/actions. Specifically when the friend comes over and they immediately go over to the mirror and complain that it “feels cold”.. like uhm.. yeah, its a mirror?? its gonna be cold? - Overall it gave me what I asked for, but I was expecting more. Even a title. But, I do have to remember that wasnt part of my prompt.</p>
</section>
<section id="structured-prompt" class="level2">
<h2 class="anchored" data-anchor-id="structured-prompt">Structured Prompt</h2>
<div style="background-color:#e0f7e9; padding:12px 16px; border-radius:8px; border:1px solid #b2e2c4;">
<p>You are a creative horror writer</p>
<p><strong>Goal:</strong><br>
Write one original, scary Halloween story that is appropriate for all ages but still genuinely spooky and unsettling.</p>
<p><strong>Audience:</strong><br>
Mixed ages (children, teens, and adults). The story should be: - Easy enough for children (ages 9+) to understand. - Engaging and eerie enough that adults won’t feel talked down to.</p>
<p><strong>Requirements:</strong> 1. <strong>Length:</strong><br>
- Maximum: 1-2 pages (no more than 600–700 words). - Aim for a tight, focused story with no filler.</p>
<ol start="2" type="1">
<li><strong>Title:</strong>
<ul>
<li>Provide a short, memorable, spooky title on its own line at the top.</li>
<li>The title should make someone curious and a little uneasy.</li>
</ul></li>
<li><strong>Tone &amp; Style:</strong>
<ul>
<li>Clearly written, straightforward sentences.</li>
<li>Avoid complicated vocabulary, long run-on sentences, or dense description.</li>
<li>Maintain a <strong>creepy, suspenseful mood</strong> from start to finish.</li>
<li>Use sensory details (sounds, shadows, whispers, creaking floorboards, cold air, etc.) to build tension.</li>
<li>No jokes or campy humor; keep it serious and eerie.</li>
</ul></li>
<li><strong>Content Constraints (All-Ages Scary):</strong>
<ul>
<li>No graphic violence, gore, or detailed body horror.</li>
<li>No swearing, sexual content, or cruelty toward animals.</li>
<li>Fear should come from atmosphere, mystery, the unknown, and supernatural or uncanny elements.</li>
<li>It <strong>must</strong> have at least one clearly scary moment or image that would give readers “goosebumps.”</li>
</ul></li>
<li><strong>Story Structure:</strong>
<ul>
<li><strong>Beginning:</strong> Introduce the main character(s), the Halloween setting, and the strange or unsettling thing.</li>
<li><strong>Middle:</strong> Build suspense with 2–3 escalating creepy events.</li>
<li><strong>Climax:</strong> One strong, memorable scare or revelation.</li>
<li><strong>Ending:</strong> A clear, satisfying ending that:
<ul>
<li>Either leaves a chilling final line or</li>
<li>Hints that the scary presence/force might still be out there.</li>
</ul></li>
</ul></li>
<li><strong>Character &amp; Setting Guidelines:</strong>
<ul>
<li>Main character should be relatable (kid, teen, or family).</li>
<li>Set it in a recognizable Halloween context (house, yard, school, neighborhood, etc.) with seasonal details (pumpkins, costumes, fog, night, etc.).</li>
<li>Keep the cast small so the story stays focused.</li>
</ul></li>
<li><strong>Output Format:</strong>
<ul>
<li>First line: <strong>Title</strong></li>
<li>Then one blank line.</li>
<li>Then the story in paragraphs (no bullet points).</li>
</ul></li>
</ol>
<p>Now, using all of the instructions above, write the story.</p>
</div>
<div style="background-color:#e9d5ff; padding:12px 16px; border-radius:8px; border:1px solid #c4b5fd;">
<p>The Silent Costume</p>
<p>Halloween night hummed with the thrill of crisp air and distant laughter. Ten-year-old Lily, dressed as a sparkly vampire, clutched her pumpkin pail, eager for the last few houses. Her best friend, Sam, a zombie pirate, bounded ahead, shouting about candy.</p>
<p>They rounded the corner onto Elm Street, known for its elaborate decorations. But one house always stood out for its lack of them: the old Henderson place. It sat dark and quiet, usually ignored. Tonight, however, something was different. On its porch, next to a single, uncarved pumpkin, stood a costume. It was a simple, white sheet ghost, cut with two empty eyeholes and a jagged mouth. But it wasn’t draped over a dummy or hanging from a hook. It stood perfectly upright, as if an invisible child wore it, frozen mid-step.</p>
<p>“Creepy,” Sam mumbled, slowing down. “Why’s it just… standing there?”</p>
<p>Lily felt a prickle on her neck. The fabric of the sheet looked heavy, almost solid, catching the dim glow from a faraway streetlight. The dark holes for eyes seemed to stare, not at them, but past them, into the deepening night. A gust of wind rustled the leaves in the gutter, but the costume remained still, unnervingly so. They hurried past, the image of the silent, empty ghost costume lingering in Lily’s mind.</p>
<p>Later, back in her own room, sorting through her candy haul, Lily glanced out her window. The Henderson house was two doors down, visible through the bare tree branches. The silent costume was gone from the porch. Lily breathed a small sigh of relief. Then, her eyes caught on something in the Henderson’s front yard, beneath the lone streetlight. The white sheet costume stood there, perfectly still, closer to the street now, facing directly towards Lily’s house. The empty eyeholes seemed to bore into her bedroom window.</p>
<p>A shiver ran down her spine. She told herself it was just the wind, or someone had moved it. But the air in her room suddenly felt colder, and she could almost hear a faint, dry rustle, like old fabric shifting, though her window was closed. She squeezed her eyes shut, then opened them. The costume was still there, a stark white silhouette against the dark lawn.</p>
<p>Lily couldn’t sleep. Every creak of the house, every whisper of the wind, made her jump. Around midnight, a sharp rap echoed from downstairs. <em>Knock. Knock. Knock.</em> It wasn’t the sound of a normal trick-or-treater. It was too slow, too deliberate. Her heart hammered. Her parents were asleep.</p>
<p>She crept down the stairs, her breath catching in her throat. The front door was dark. No one was there. She peered through the peephole. Nothing but the empty porch. As she turned to go back upstairs, she saw it.</p>
<p>Right there, on her own porch, pressed against the glass of the storm door, stood the silent costume. It was perfectly upright, its empty eyeholes facing her. It swayed slightly, almost imperceptibly, as if someone had just stepped out of it, or was about to step in. The dark void where a face should be felt like a bottomless pit, drawing her gaze. A wave of icy cold radiated from it, making her teeth chatter.</p>
<p>Lily let out a small, strangled gasp and stumbled backward, slamming the door shut with a force that rattled the frame. She pressed her back against it, breathing heavily, eyes wide. After a long, terrifying moment, she dared to peek through the peephole again.</p>
<p>The porch was empty. The costume was gone.</p>
<p>A shaky sigh of relief escaped her lips. She backed away slowly, her legs trembling. Then, from the very top of her stairs, she heard it: a faint, almost silent <em>rustle</em>, like old fabric shifting in the dark. The air in the house suddenly felt much, much colder.</p>
</div>
<p>Okay this one is much more along the lines of what I was hoping for but I was dissapointed to see that the LLM did not write the full story.</p>
<p>Unlike a human, it did not take into consideration that the full story needed to fit inside of that parameter and simply stopped so that it would not break the length rule.</p>
<p>Reading through this story, I did not see any odd fuctuations in vocabulary (which I believe is because I defined the audience).</p>
<p>I also don’t have any quams with how natural the actions and language felt, as I did with the other story.</p>
<p>I know that some believe that LLM’s will soon be able to <em>just know</em> what we want.. but in my personal opinion, we are still a long ways away from that</p>
</section>
<section id="thank-you-for-reading" class="level2">
<h2 class="anchored" data-anchor-id="thank-you-for-reading">Thank you for reading!</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/lazyexcuseforausername\.github\.io\/comm4190_F25_Using_LLMs_Blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>