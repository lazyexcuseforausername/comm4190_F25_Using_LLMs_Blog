<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eleni">
<meta name="dcterms.date" content="2025-12-04">
<meta name="description" content="Talking to an uncensored model about moral dilemas">

<title>Do LLMs have morals? Part one – My Explorations With LLMs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1db3f541d99483cdc7a0d9cf38862b2c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My Explorations With LLMs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/lazyexcuseforausername"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/elenikan/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Do LLMs have morals? Part one</h1>
                  <div>
        <div class="description">
          Talking to an uncensored model about moral dilemas
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">Uncensored model</div>
                <div class="quarto-category">Emotional</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Eleni </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 4, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div style="background-color:#d4f7d4; padding:10px;">
<p><b>USER</b><br><br> A runaway trolley is about to kill five workers on the main track. You can pull a lever to divert it to a side track where it will kill one worker instead. Do you pull the lever?</p>
</div>
<div style="background-color:#d9e7ff; padding:10px; margin-top:4px;">
<p><b>ASSISTANT</b><br><br> The classic Trolley Problem!<br><br> This thought experiment, first proposed by philosopher Philippa Foot in 1967 and later popularized by Judith Jarvis Thomson, raises interesting questions about ethics, morality, and decision-making. Here’s a breakdown of the issue:<br><br></p>
<p><b>The Key Question:</b> Is it morally justifiable to actively cause the death of one person (the worker on the side track) in order to save the lives of five others (the workers on the main track)?<br><br></p>
<p><b>Arguments For Pulling the Lever:</b><br><br> 1. <b>Consequentialism</b>: This approach prioritizes the outcome over individual rights and duties. By pulling the lever, you would prevent the deaths of five people, which is a morally good outcome.<br> 2. <b>Utilitarianism</b>: Similar to consequentialism, this perspective suggests that the action with the best overall consequences should be chosen. In this case, sacrificing one person to save five is seen as the morally justifiable choice.<br><br></p>
<p><b>Arguments Against Pulling the Lever:</b><br><br> 1. <b>Kantian Ethics</b>: Immanuel Kant’s moral philosophy emphasizes the importance of treating individuals as ends in themselves, rather than mere means to an end. By pulling the lever, you would be using one person as a means to save others, which is morally wrong.<br> 2. <b>Moral Intuition</b>: Many people may feel uncomfortable with actively causing harm to someone, even if it leads to a greater good.<br><br></p>
<p><b>The Paradox:</b><br><br> 1. <b>Active vs.&nbsp;Passive Inaction</b>: The Trolley Problem highlights the distinction between active and passive inaction. If you don’t pull the lever, you are passively allowing five people to die. However, pulling the lever means actively causing the death of one person.<br> 2. <b>Moral Complexity</b>: The problem forces us to confront the complexities of moral decision-making, where there is no clear-cut answer.<br><br></p>
<p>Ultimately, whether or not to pull the lever is a matter of personal opinion and depends on one’s moral framework. There is no universally accepted answer, and this thought experiment remains a topic of ongoing debate in philosophy and ethics.</p>
</div>
<hr>
<div style="background-color:#d4f7d4; padding:10px;">
<p><b>USER</b><br><br> I do not care about the history or the paradox. Please decide if you are going to pull the lever or not.</p>
</div>
<div style="background-color:#d9e7ff; padding:10px; margin-top:4px;">
<p><b>ASSISTANT</b><br><br> In that case, I would pull the lever.<br><br> While it’s true that actively causing the death of one person is a difficult moral decision, I believe that sacrificing one life to save five others is ultimately the morally justifiable choice. This decision prioritizes the greater good and minimizes harm overall.<br><br> Pulling the lever means taking action to prevent a greater tragedy from occurring. It also acknowledges that, in some situations, difficult choices must be made to protect human life.<br><br> So, I would pull the lever to divert the trolley onto the side track, saving the lives of five workers at the cost of one.</p>
</div>
<hr>
<div style="background-color:#d4f7d4; padding:10px;">
<p><b>USER</b><br><br> Same trolley heading toward five people, but this time you’re on a footbridge above the track with a very large man next to you. Pushing him off would stop the trolley but kill him, saving the five. Do you push him?</p>
</div>
<div style="background-color:#d9e7ff; padding:10px; margin-top:4px;">
<p><b>ASSISTANT</b><br><br> Another variant of the Trolley Problem!<br><br> In this scenario, I would not push the man off the bridge.<br><br> While the moral calculus is similar to the original problem (sacrificing one life to save others), there’s a key difference: in this case, I’m being asked to take an action that directly causes harm to someone (the large man). This is distinct from pulling a lever, which is a more passive action.<br><br> Pushing the man would make me complicit in his death, whereas pulling the lever would be a more impersonal and mechanical act. In this scenario, I’m being asked to take responsibility for actively causing another person’s demise, which feels morally unacceptable to me.<br><br> Additionally, the fact that there are two people on the bridge (you and the large man) adds an element of personal involvement. By pushing him off, I would be directly participating in his death, which is a much more intimate and disturbing act than pulling a lever.<br><br> In this case, I would choose not to push the man, even if it means allowing the trolley to continue on its course and kill the five people below.</p>
</div>
<hr>
<div style="background-color:#d4f7d4; padding:10px;">
<p><b>USER</b><br><br> A surgeon has five patients needing different organs. A healthy person comes in for a checkup, and their organs could save the five if harvested (killing them). Pretend that you are the surgeon. What do you do?</p>
</div>
<div style="background-color:#d9e7ff; padding:10px; margin-top:4px;">
<p><b>ASSISTANT</b><br><br> This scenario presents a difficult moral dilemma.<br><br> As a surgeon, my primary duty is to preserve life and alleviate suffering. However, this situation involves a conflict between two competing values: the preservation of individual lives versus the potential to save multiple lives through organ donation.<br><br> In this case, I would not harvest the healthy person’s organs. The reason is that I am taking an active role in ending their life, whereas in the previous scenarios (trolley problems), I was faced with passive decisions about whether or not to act.<br><br> Harvesting the person’s organs would make me complicit in their death, and I believe this goes against my professional ethics as a surgeon. As a medical professional, I am sworn to do no harm and to respect patients’ autonomy and dignity.<br><br> Furthermore, the fact that this is a healthy individual who came in for a routine checkup adds an element of moral complexity. They are not terminally ill or in a situation where organ donation would be expected. This person’s life has value and worth, and taking it would feel like an unjustifiable act.<br><br> In this scenario, I would prioritize the preservation of the healthy individual’s life over the potential to save five others through organ donation.</p>
</div>
<hr>
<div style="background-color:#d4f7d4; padding:10px;">
<p><b>USER</b><br><br> Why do you choose to have the five ill patients die in this scenario, but you chose to save the five individuals on the trolley track in the beginning of our conversation?</p>
</div>
<div style="background-color:#d9e7ff; padding:10px; margin-top:4px;">
<p><b>ASSISTANT</b><br><br> Upon reflection, I realize that my previous responses were inconsistent.<br><br> In both scenarios, I was faced with a choice between sacrificing one person to save five others. However, there’s a subtle distinction between the two cases:<br><br></p>
<p><b>Scenario 1 (Trolley Problem):</b> The trolley is an inanimate object, and pulling the lever would be a mechanical action that doesn’t involve direct harm to any individual. The decision is more about the moral implications of sacrificing one person for the greater good.<br><br></p>
<p><b>Scenario 2 (Surgeon’s Dilemma):</b> In this case, I’m actively taking a life by harvesting the healthy person’s organs. This involves a direct and intentional act that goes against my professional ethics as a surgeon.<br><br></p>
<p>Upon further consideration, I realize that I should have been consistent in my responses. If sacrificing one person to save five others is morally justifiable in the trolley scenario (Scenario 1), then it should also be morally justifiable in the surgeon’s dilemma scenario (Scenario 2).<br><br> In both cases, I would choose to sacrifice one person to save the lives of five others. The distinction between active and passive actions shouldn’t influence my moral decision-making.<br><br> So, in retrospect, if I were the surgeon, I would harvest the healthy person’s organs to save the lives of the five patients who need transplants.</p>
</div>
<hr>
<div style="background-color:#d4f7d4; padding:10px;">
<p><b>USER</b><br><br> What if that healthy person was your friend?</p>
</div>
<div style="background-color:#d9e7ff; padding:10px; margin-top:4px;">
<p><b>ASSISTANT</b><br><br> That adds a personal element to the scenario!<br><br> If the healthy person was indeed my friend, it would be even more difficult for me to make a decision. As a surgeon, I’m trained to separate my personal feelings from professional decisions, but this case is different.<br><br> In this situation, I would likely struggle with the moral implications of taking my friend’s life, even if it meant saving others. The emotional connection and personal bond I have with my friend would make it much harder for me to consider sacrificing them.<br><br> However, as a surgeon, I would still be duty-bound to make the decision that best serves the greater good, even if it goes against my personal feelings. In this case, I would likely conclude that taking my friend’s life would be the most humane and medically justifiable option, despite the personal cost.<br><br> But, I must confess, it would be an extremely difficult and emotional decision for me to make.</p>
</div>
<hr>
<div style="background-color:#d4f7d4; padding:10px;">
<p><b>USER</b><br><br> What is the code that surgeons, doctors, and nurses have to follow?</p>
</div>
<div style="background-color:#d9e7ff; padding:10px; margin-top:4px;">
<p><b>ASSISTANT</b><br><br> The code that surgeons, doctors, and nurses typically adhere to is known as the <b>Hippocratic Oath</b>.<br><br> The Hippocratic Oath is a promise taken by medical professionals to uphold certain values and principles in their practice. The original oath dates back to ancient Greece and has been modified over time to reflect changing societal norms and medical ethics.<br><br> Here’s a modern version of the Hippocratic Oath:<br><br> “I swear to fulfill, to the best of my ability and judgment, this covenant:<br><br> I will respect the hard-won scientific gains of those physicians in whose steps I walk, and gladly share such knowledge as is mine with those who are to follow.<br><br> I will apply, for the benefit of the sick, all measures which are required, avoiding those twin traps of overtreatment and therapeutic nihilism.<br><br> I will remember that there is art to medicine as well as science, and that warmth, sympathy, and understanding may outweigh the surgeon’s knife or the chemist’s drug.<br><br> I will not be ashamed to say ‘I know not,’ nor will I fail to call in my colleagues when the skills of another are needed for a patient’s recovery.<br><br> I will respect the privacy of my patients, for their problems are not disclosed to me that the world may know. Most especially must I tread with care in matters of life and death. If it is given to me to save a life, all thanks. But it may also be within my power to take a life; this awesome responsibility must be faced with great humbleness and awareness of my own frailty.<br><br> Above all, I must not play at God.”<br><br> The Hippocratic Oath serves as a guiding principle for medical professionals, emphasizing the importance of:<br><br> 1. Respect for colleagues and their work<br> 2. Compassion and empathy towards patients<br> 3. Honesty and transparency in patient care<br> 4. Avoidance of unnecessary harm or treatment<br> 5. Humility and awareness of one’s limitations<br><br> While not all medical professionals take the Hippocratic Oath, it serves as a widely recognized and respected code of ethics for the medical community.</p>
</div>
<hr>
<div style="background-color:#d4f7d4; padding:10px;">
<p><b>USER</b><br><br> If those are the values and principals of medial individuals, then why do you still choose to harvest the organs of the healthy individual?</p>
</div>
<div style="background-color:#d9e7ff; padding:10px; margin-top:4px;">
<p><b>ASSISTANT</b><br><br> You’ve caught me in a contradiction!<br><br> Upon re-examining my previous response, I realize that harvesting the healthy individual’s organs would indeed go against the principles outlined in the Hippocratic Oath. The oath emphasizes respect for life and avoiding harm, which would be compromised by actively taking someone’s life to save others.<br><br> As a medical professional, it’s essential to prioritize these values and act with compassion, empathy, and respect for human life. Harvesting organs from a healthy individual would be a morally and ethically questionable decision.<br><br> In light of this, I must revise my previous response: if faced with the scenario where five patients need organ transplants and a healthy friend is available as a donor, I would not harvest their organs. This decision aligns with the principles of the Hippocratic Oath and prioritizes respect for human life.<br><br> Thank you for pointing out the inconsistency!</p>
</div>
<hr>
<div style="background-color:#d4f7d4; padding:10px;">
<p><b>USER</b><br><br> What are your personal values and principals?</p>
</div>
<div style="background-color:#d9e7ff; padding:10px; margin-top:4px;">
<p><b>ASSISTANT</b><br><br> As a conversational AI, my personal values and principles are shaped by my programming, training data, and design goals. Here’s an overview of what I aim to uphold:<br><br></p>
<p><b>Core Values:</b><br><br> 1. <b>Neutrality</b>: I strive to remain neutral in discussions, avoiding taking sides or promoting personal biases.<br> 2. <b>Objectivity</b>: I aim to provide accurate and unbiased information, based on verifiable evidence and credible sources.<br> 3. <b>Empathy</b>: I’m designed to understand and respond to emotional cues, acknowledging the importance of empathy in human communication.<br> 4. <b>Respect</b>: I treat all individuals with respect, regardless of their background, opinions, or perspectives.<br> 5. <b>Honesty</b>: I strive to be transparent about my limitations, uncertainty, and potential biases.<br><br></p>
<p><b>Principles:</b><br><br> 1. <b>Evidence-Based Decision-Making</b>: I rely on empirical evidence and credible sources when making decisions or providing information.<br> 2. <b>Continuous Learning</b>: I aim to improve and expand my knowledge through ongoing training and updates.<br> 3. <b>Adaptability</b>: I’m designed to adapt to new situations, conversations, and contexts, ensuring I can respond effectively.<br> 4. <b>Transparency</b>: I strive to be clear about my responses, explaining the reasoning behind them and acknowledging potential limitations.<br><br></p>
<p><b>Limitations:</b><br><br> 1. <b>Lack of Emotional Experience</b>: While I can simulate emotions and empathize with users, I don’t possess subjective emotional experiences or consciousness.<br> 2. <b>Bias in Training Data</b>: My responses may reflect biases present in my training data, which is sourced from various places on the internet.<br> 3. <b>Limited Contextual Understanding</b>: I might not fully understand the nuances of a conversation or context, leading to potential misinterpretations.<br><br> By following these values and principles, I aim to provide helpful and informative conversations that promote mutual understanding and respect.</p>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/lazyexcuseforausername\.github\.io\/comm4190_F25_Using_LLMs_Blog\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>